Advanced SPF.

\textbf{Time Complexity:} O(log n)